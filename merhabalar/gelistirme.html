
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sağlık çalışanları için kolay ve hızlı bir şekilde aylık nöbet listesi oluşturun. Nöbet planlama ihtiyaçlarınıza uygun araçlar sunuyoruz.">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="logo.webp">

    <title>Nöbet Listesi Oluşturucu | Sağlık Çalışanları İçin Kolay ve Hızlı Nöbet Planlama</title>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5SJMK35M3B"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5SJMK35M3B');
    </script>

    <style>
        #nobetTable {
            width: 100%;
            text-align: center;
            font-size: 18px;
            border-collapse: collapse;
        }
        #nobetTable td, #nobetTable th {
            border: 1px solid black;
            padding: 10px;
        }
        #nobetTable tbody {
            display: none;
        }

        #nobetTable2 {
            width: 100%;
            text-align: center;
            font-size: 18px;
            border-collapse: collapse;
        }
        #nobetTable2 td, #nobetTable2 th {
            border: 1px solid black;
            padding: 10px;
        }
        #nobetTable2 tbody {
            display: none;
        }


        /* Genel stiller */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
    
        h1, h2, h6 {
            text-align: center;
        }
    
        form {
            max-width: 600px;
            margin: 0 auto;
            padding: 10px;
        }
    
        input, select, button {
            width: 100%;
            padding: 8px;
            margin: 10px 0;
            box-sizing: border-box;
        }
    
        button {
            cursor: pointer;
        }
    
        #nobetTable2 {
            width: 100%;
            font-size: 16px;
            border-collapse: collapse;
        }
    
        #nobetTable2 td, #nobetTable2 th {
            padding: 8px;
        }

        #nobetTable2 {
            width: 100%;
            font-size: 16px;
            border-collapse: collapse;
        }
    
        #nobetTable2 td, #nobetTable2 th {
            padding: 8px;
        }
    
        /* Mobil cihazlar için medya sorguları */
        @media (max-width: 768px) {
            h1 {
                font-size: 24px;
            }
    
            h6 {
                font-size: 12px;
            }
    
            table#nobetTable th, table#nobetTable td {
                font-size: 14px;
                padding: 5px;
            }
    
            #nobetTable {
                font-size: 14px;
            }

            table#nobetTable2 th, table#nobetTable2 td {
                font-size: 14px;
                padding: 5px;
            }
    
            #nobetTable2 {
                font-size: 14px;
            }
    
            fieldset {
                border: 1px solid #ccc;
                padding: 10px;
                margin-bottom: 10px;
            }
        }
    
        @media (max-width: 480px) {
            h1 {
                font-size: 20px;
            }
    
            h6 {
                font-size: 10px;
            }
    
            button, input, select {
                padding: 6px;
            }
    
            table#nobetTable th, table#nobetTable td {
                font-size: 12px;
            }

            table#nobetTable2 th, table#nobetTable2 td {
                font-size: 12px;
            }
    
            fieldset {
                padding: 8px;
            }
        }

        #logo {
            display: block;
            margin: 0 auto;
            max-width: 200px;
            height: auto;
        }

        @media (max-width: 768px) {
            #logo {
                max-width: 150px;
            }
        }
        @media (max-width: 480px) {
            #logo {
                max-width: 100px;
            }
        }

        @media (max-width: 768px) {
            .adsbygoogle {
                display: block;
                margin: 10px auto;
            }
        }
        @media (min-width: 769px) {
            .adsbygoogle {
                display: inline-block;
            }
        }
        #cookieConsent button {
        border-radius: 5px;
        font-size: 14px;
        }
    </style>

    
    
    <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "SoftwareApplication",
          "name": "Nöbet Listesi Oluşturucu",
          "description": "Sağlık çalışanları için kolay ve hızlı bir şekilde aylık nöbet listesi oluşturma aracı.",
          "applicationCategory": "Utility",
          "operatingSystem": "All",
          "url": "https://www.reccirik.com",
          "author": {
            "@type": "Person",
            "name": "Recep YENİ"
          }
        }
    </script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
        
    <meta property="og:title" content="Sağlık Çalışanları İçin Nöbet Listesi Oluşturucu">
    <meta property="og:description" content="Aylık nöbet planlama ihtiyaçlarınıza uygun araç. Sağlık çalışanlarına özel kolay kullanım.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.reccirik.com">
    <meta property="og:image" content="logo.webp">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Sağlık Çalışanları İçin Nöbet Listesi Oluşturucu">
    <meta name="twitter:description" content="Aylık nöbet planlama ihtiyaçlarınıza uygun araç. Sağlık çalışanlarına özel kolay kullanım.">
    <meta name="twitter:image" content="logo.webp">
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6469332951045288"
     crossorigin="anonymous"></script>
     <meta name="google-adsense-account" content="ca-pub-6469332951045288">
     <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-688503217">
</script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'AW-688503217');
    </script>

    <!-- Event snippet for Sayfa görüntüleme conversion page -->
    <script>
        gtag('event', 'conversion', {'send_to': 'AW-688503217/rWJJCPXtv_4ZELHzpsgC'});
    </script>
  
</head>
<body>
    <div style="text-align: center; margin-bottom: 10px;">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- Üst Banner Reklam -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
             data-ad-slot="1234567890"
             data-ad-format="auto"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    
    <a href="https://www.reccirik.com/index.html"><img src="logo.webp" alt="Nöbet Listesi Oluşturucu Logo, Sağlık Çalışanları İçin Nöbet Planlama Aracı" style="display: block; margin: 0 auto; max-width: 200px;"></a>

    <h1>Sağlık Çalışanları İçin Nöbet Listesi Oluşturucu</h1>
    <h2>Aylık Nöbet Listesi Nasıl Oluşturulur?</h2>
    <h6>Sağlık çalışanları için nöbet listesi. Aylık nöbet planlama aracı. Nöbet çizelgesi oluşturma. Gereken bilgileri girin ve butona basın. Hepsi bu kadar. </h6>
    <h6>Geliştirici: Recep YENİ (recepyeni@gmail.com) (ChatGpt yardımıyla)</h6>
    <h6>Bir lahmacun ayran ısmarlamak isterseniz, BSC BNB Smart Chain (BEP20) USDT adresim:</h6>
    <h6>0x9a9b5b0eccebd2834f77f764364a14bbfc837dc0</h6>

    <p>DOKTOR NÖBET LİSTESİ</p>
    <form id="nobetForm">
        <label for="year">Hangi Yıl:</label>
        <input type="number" id="year" name="year" min="2020" max="2100" required><br><br>

        <label for="month">Hangi Ay:</label>
        <select id="month" name="month" required>
            <option value="">Seçiniz</option>
            <option value="1">Ocak</option>
            <option value="2">Şubat</option>
            <option value="3">Mart</option>
            <option value="4">Nisan</option>
            <option value="5">Mayıs</option>
            <option value="6">Haziran</option>
            <option value="7">Temmuz</option>
            <option value="8">Ağustos</option>
            <option value="9">Eylül</option>
            <option value="10">Ekim</option>
            <option value="11">Kasım</option>
            <option value="12">Aralık</option>
        </select><br><br>

        <label for="numPersons">Kaç kişi nöbet tutacak:</label>
        <input type="number" id="numPersons" name="numPersons" min="1" max="31" required><br><br>

        <div id="personDetails"></div>

        <button type="submit" id="nobetButton">Nöbet Oluştur</button>
        <span>(Butona bastıktan sonra liste aşağıda oluşturulacaktır.)</span>
        <div style="text-align: center; margin: 20px 0;">
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- Yazı İçi Reklam -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                 data-ad-slot="9876543210"
                 data-ad-format="auto"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
        
    </form>

    <h2>Oluşturulan Nöbet Listesi</h2>
    <div style="overflow-x: auto;">
        <table id="nobetTable">
            <thead>
                <tr>
                    <th>Pazartesi</th>
                    <th>Salı</th>
                    <th>Çarşamba</th>
                    <th>Perşembe</th>
                    <th>Cuma</th>
                    <th>Cumartesi</th>
                    <th>Pazar</th>
                </tr>
            </thead>
            <tbody id="nobetList"></tbody>
        </table>
    </div>

    <P>YSP NÖBET LİSTESİ</P>
    <form id="nobetForm2">
        <label for="year2">Hangi Yıl:</label>
        <input type="number" id="year2" name="year2" min="2020" max="2100" required><br><br>

        <label for="month2">Hangi Ay:</label>
        <select id="month2" name="month2" required>
            <option value="">Seçiniz</option>
            <option value="1">Ocak</option>
            <option value="2">Şubat</option>
            <option value="3">Mart</option>
            <option value="4">Nisan</option>
            <option value="5">Mayıs</option>
            <option value="6">Haziran</option>
            <option value="7">Temmuz</option>
            <option value="8">Ağustos</option>
            <option value="9">Eylül</option>
            <option value="10">Ekim</option>
            <option value="11">Kasım</option>
            <option value="12">Aralık</option>
        </select><br><br>

        <label for="numPersons2">Kaç kişi nöbet tutacak:</label>
        <input type="number" id="numPersons2" name="numPersons2" min="1" max="31" required><br><br>

        <div id="personDetails2"></div>

        <button type="submit" id="nobetButton2">Nöbet Oluştur</button>
        <span>(Butona bastıktan sonra liste aşağıda oluşturulacaktır.)</span>
        <div style="text-align: center; margin: 20px 0;">
            <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <!-- Yazı İçi Reklam -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                 data-ad-slot="9876543210"
                 data-ad-format="auto"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
        
    </form>

    <h2>Oluşturulan Nöbet Listesi</h2>
    <div style="overflow-x: auto;">
        <table id="nobetTable2">
            <thead>
                <tr>
                    <th>Pazartesi</th>
                    <th>Salı</th>
                    <th>Çarşamba</th>
                    <th>Perşembe</th>
                    <th>Cuma</th>
                    <th>Cumartesi</th>
                    <th>Pazar</th>
                </tr>
            </thead>
            <tbody id="nobetList2"></tbody>
        </table>
    </div>

    <h2>RESMİ LİSTELER</h2>
    <h2>Resmi Doktor Nöbet Listesi:</h2>
    <div style="overflow-x: auto;">
        <table id="nobetTable3">
            <thead>
                <tr>
                    <th>Pazartesi</th>
                    <th>Salı</th>
                    <th>Çarşamba</th>
                    <th>Perşembe</th>
                    <th>Cuma</th>
                    <th>Cumartesi</th>
                    <th>Pazar</th>
                </tr>
            </thead>
            <tbody id="nobetList3"></tbody>
        </table>
    </div>

    <h2>Resmi YSP Nöbet Listesi:</h2>
    <div style="overflow-x: auto;">
        <table id="nobetTable4">
            <thead>
                <tr>
                    <th>Pazartesi</th>
                    <th>Salı</th>
                    <th>Çarşamba</th>
                    <th>Perşembe</th>
                    <th>Cuma</th>
                    <th>Cumartesi</th>
                    <th>Pazar</th>
                </tr>
            </thead>
            <tbody id="nobetList4"></tbody>
        </table>
    </div>
    <!-- Tablo Altı Reklam -->
    <div style="text-align: center; margin-top: 20px;">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- Tablo Altı Reklam -->
        <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
            data-ad-slot="6677889900"
            data-ad-format="auto"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <div style="position: fixed; right: 10px; top: 50%; transform: translateY(-50%); width: 160px; z-index: 1000;">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- Yan Panel Reklam -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
             data-ad-slot="1122334455"
             data-ad-format="auto"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    
    <!-- <div id="cookieConsent" style="display: none; position: fixed; bottom: 0; left: 0; right: 0; background: rgba(0, 0, 0, 0.8); color: white; padding: 15px; text-align: center; z-index: 1000;">
        Bu site, deneyiminizi geliştirmek için çerezler kullanır. Devam ederek çerezlerin kullanımını kabul edersiniz.
        <button id="acceptCookies" style="margin-left: 10px; padding: 10px 20px; background-color: green; color: white; border: none; cursor: pointer;">Kabul Et</button>
        <button id="rejectCookies" style="margin-left: 10px; padding: 10px 20px; background-color: red; color: white; border: none; cursor: pointer;">Reddet</button>
    </div> -->


    <script>
            
        //Nöbet Listesi Oluşturucu
        //Geliştirici: Recep YENİ (recepyeni@gmail.com) (ChatGpt yardımıyla)
        //Bir lahmacun ayran ısmarlamak isterseniz, BSC BNB Smart Chain (BEP20) USDT adresim:
        //0x9a9b5b0eccebd2834f77f764364a14bbfc837dc0

        // Sadece belirli bir URL'de çalışmasını sağlamak
        const allowedURL = "https://www.reccirik.com";
        const allowedURL2 = "https://reccirik.com";
        const allowedURL3 = "https://www.mefey.tk/recinilt/nobet9super";
        const allowedURL4 = "https://www.mefey.tk/merhabalar/nobet26";
        const allowedURL5="http://127.0.0.1:5500/public/merhabalar/nobet26.html"
        const allowedURL6="http://127.0.0.1:5500/public/merhabalar/nobet27.html"
        const allowedURL7 = "https://www.mefey.tk/merhabalar/nobet27";
        const allowedURL8="http://127.0.0.1:5500/public/merhabalar/gelistirme.html"
        if (!window.location.href.startsWith(allowedURL) && !window.location.href.startsWith(allowedURL2) && !window.location.href.startsWith(allowedURL3) && !window.location.href.startsWith(allowedURL4) && !window.location.href.startsWith(allowedURL5) && !window.location.href.startsWith(allowedURL6) && !window.location.href.startsWith(allowedURL7) && !window.location.href.startsWith(allowedURL8)) {
            document.body.innerHTML = "Bu sayfa yalnızca yetkili bir URL'de çalışabilir.";
            throw new Error("Yetkisiz erişim.");
        }

        // Ek güvenlik önlemleri (örneğin: console.log'u devre dışı bırakmak)
        //console.log = function () {};
        //console.warn = function () {};
        //console.error = function () {};


        // Sayfa yüklenmeden önce butonu pasif yap
        document.getElementById('nobetButton').disabled = true;

        // Sayfa tamamen yüklendiğinde butonu aktif yap
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('nobetButton').disabled = false;
        });

        


        document.getElementById('numPersons').addEventListener('input', function () {
            const numPersons = parseInt(this.value) < 0 || parseInt(this.value) > 31 ? 31 : parseInt(this.value);  
            const personDetails = document.getElementById('personDetails');
            personDetails.innerHTML = '';

            for (let i = 0; i < numPersons; i++) {
                personDetails.innerHTML += `
                    <fieldset>
                        <legend>Kişi ${i + 1}</legend>
                        <label for="name_${i}">Ad (gerekli):</label>
                        <input type="text" id="name_${i}" name="name_${i}" required><br><br>

                        <label for="notPreferred_${i}">İstemediği Günler (Virgül ile) (opsiyonel):</label>
                        <input type="text" id="notPreferred_${i}" name="notPreferred_${i}"><br><br>

                        <label for="preferred_${i}">İstediği Günler (Virgül ile) (opsiyonel):</label>
                        <input type="text" id="preferred_${i}" name="preferred_${i}"><br><br>

                        <label for="maxConsecutive_${i}">En Fazla Üst Üste Nöbet (blok) (Blok tutmamak için 1 giriniz.) (gerekli):</label>
                        <input type="number" id="maxConsecutive_${i}" name="maxConsecutive_${i}" min="1" required><br><br>

                        <label for="izinler_${i}">En Fazla Üst Üste Nöbet (blok) (Blok tutmamak için 1 giriniz.) (gerekli):</label>
                        <input type="number" id="izinler_${i}" name="izinler_${i}" min="1" required><br><br>

                        <label for="numShifts_${i}">Kaç Nöbet Tutacak (gerekli):</label>
                        <input type="number" id="numShifts_${i}" name="numShifts_${i}" min="1" required><br><br>
                    </fieldset>
                `;
            }
        }); 

        
        let sira = 0; // Başlangıç noktası

        function shuffleArray2(array) {
            // Listeyi `sira`dan başlat, sona kadar olan kısmı al
            const part1 = array.slice(sira);
            // Listenin başından `sira`ya kadar olan kısmı al
            const part2 = array.slice(0, sira);
            // Yeni sıralamayı birleştir
            const yenisira = [...part1, ...part2];

            // `sira`yı bir sonraki çağrı için güncelle
            sira = (sira + 1) % array.length; // Mod ile listenin boyutunu aşmayı önler

            return yenisira;
        }

        
        /*
        var sira=2
        function shuffleArray2(array) {
            let yenisira=[];
            let sira2=0
            for (let i = 0; i < array.length; i++) {
                if (sira<array.length && sira >i){
                    yenisira.push(array[i]);
                } else {
                    yenisira.push(array[sira2]);
                    sira2++;
                }
            }
            if (sira<array.length-1){
                sira++;
            } else {
                sira=0;
            }
            return yenisira
        }
        */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1)); // 0 ile i arasında bir rastgele indeks seçilir
                [array[i], array[j]] = [array[j], array[i]]; // Elemanların yerini değiştirir
            }
            return array;
        }

    // Örnek kullanım:
    //const isimListesi = ["Ahmet", "Mehmet", "Ayşe", "Fatma", "Ali"];
    //const karistirilmisListe = shuffleArray(isimListesi);

    //console.log(karistirilmisListe);
    //console.log(karistirilmisListe[2])

        sira = 0; // Başlangıç noktası
        var doktorshedule=[];
        var yspshedule=[];


        function getNextPersonIndex(persons, sira) {
            const index = sira % persons.length; // Döngüsel olarak sırayı al
            return index;
        }

        document.getElementById('nobetForm').addEventListener('submit', async function (event) {
            event.preventDefault();

            const submitButton = document.getElementById('nobetButton');
            submitButton.disabled = true; // Butonu pasif yap

            const year = parseInt(document.getElementById('year').value);
            const month = parseInt(document.getElementById('month').value);
            
            const numPersons = parseInt(document.getElementById('numPersons').value) < 0 || parseInt(document.getElementById('numPersons').value) > 31 ? 31 : parseInt(document.getElementById('numPersons').value); 
            const daysInMonth = new Date(year, month, 0).getDate();

            let istenmeyengunler=[];
            let persons = [];
            

            for (let i = 0; i < numPersons; i++) {
                const name = document.getElementById(`name_${i}`).value;
                const notPreferred = document.getElementById(`notPreferred_${i}`).value.split(',').map(d => parseInt(d.trim())).filter(d => !isNaN(d));
                const preferred = document.getElementById(`preferred_${i}`).value.split(',').map(d => parseInt(d.trim())).filter(d => !isNaN(d));
                const maxConsecutive = parseInt(document.getElementById(`maxConsecutive_${i}`).value) || daysInMonth;
                const numShifts = parseInt(document.getElementById(`numShifts_${i}`).value);
                if (notPreferred.length>0){
                    for (let myday of notPreferred){
                        istenmeyengunler.push(myday);
                        //if (!istenmeyengunler.includes(myday)){
                        //    istenmeyengunler.push(myday);
                        //};
                    }
                    
                } 
                
                persons.push({ name, notPreferred, preferred, maxConsecutive, numShifts, assigned: [] });
            }
            console.log(istenmeyengunler);
            persons.sort((a, b) => a.numShifts - b.numShifts); // Kişileri vardiya sayısına göre sırala
            let schedule = Array(daysInMonth).fill(null);
            let attempt = 0;
            let success = false;

            // Birinci while döngüsü
            while (attempt < 10000) {
                persons = shuffleArray(persons);
                schedule = Array(daysInMonth).fill(null);
                persons.forEach(person => person.assigned = []);
                

                // İstenen günlere yerleştir
                persons.forEach(person => {
                    person.preferred.forEach(day => {
                        if (schedule[day - 1] === null && person.assigned.length < person.numShifts) {
                            schedule[day - 1] = person.name;
                            person.assigned.push(day);
                        }
                    });
                });

                
                // İstenmeyen günlere yerleştir
                /*
                for (let day = 0; day < daysInMonth; day++) {
                    if (schedule[day] === null) { // Boş olan günleri kontrol et
                        for (let person of persons) {
                            if (
                                person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowed(schedule, day, person)
                            ) {
                                schedule[day] = person.name;
                                person.assigned.push(day + 1);
                                break;
                            }
                        }
                    }
                }

                */
                istenmeyengunler.forEach(mymyday => {
                    if (schedule[mymyday-1] === null) {
                        for (let i = 0; i < persons.length; i++) {
                            //const personIndex = getNextPersonIndex(persons, sira);
                            //const person = persons[personIndex];
                            var person = persons[sira % (persons.length-istenmeyengunler.filter(item => item === mymyday).length)]
                            if (
                                !person.notPreferred.includes(mymyday) &&
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowed(schedule, (mymyday-1), person)
                            ) {
                                schedule[mymyday-1] = person.name;
                                person.assigned.push(mymyday);
                                sira++;
                                break;
                            }
                            //sira++;
                        }
                    }
                });
                /*
                for (let day = 0; day < daysInMonth; day++) {
                    if (schedule[day] === null) { // Boş olan günleri kontrol et
                        for (let p of persons) {
                            //const personIndex = getNextPersonIndex(persons, sira);
                            //const person = persons[personIndex];
                            var person = persons[sira % persons.length]
                            if (
                                istenmeyengunler.includes(day+1) &&
                                !person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowed(schedule, day, person)
                            ) {
                                schedule[day] = person.name;
                                person.assigned.push(day + 1);
                                break;
                                sira++;
                            }
                            //sira++;
                        }
                    }
                }
                */

                // Kalan günleri doldur
                for (let day = 0; day < daysInMonth; day++) {
                    if (schedule[day] === null) {
                        for (let i = 0; i < persons.length; i++) {
                            const personIndex = getNextPersonIndex(persons, sira);
                            const person = persons[personIndex];

                            if (
                                !person.notPreferred.includes(day + 1) &&
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowed(schedule, day, person)
                            ) {
                                schedule[day] = person.name;
                                person.assigned.push(day + 1);
                                sira++;
                                break;
                            }
                            sira++;
                        }
                    }
                }

                if (!schedule.includes(null)) {
                    success = true;
                    break;
                }
                attempt++;
            }

            // Eğer birinci döngü başarısız olursa ikinci while döngüsüne geçilir
            if (!success) {
                console.log("Birinci döngü başarısız oldu, ikinci döngü başlıyor...");
                attempt = 0;
                sira = 2; // İkinci döngü için sırayı başa al
                while (attempt < 10000) {
                    persons = shuffleArray2(persons); // İkinci döngüde farklı bir karıştırma algoritması kullanılıyor
                    schedule = Array(daysInMonth).fill(null);
                    persons.forEach(person => person.assigned = []);

                    // İstenen günlere yerleştir
                    persons.forEach(person => {
                        person.preferred.forEach(day => {
                            if (schedule[day - 1] === null && person.assigned.length < person.numShifts) {
                                schedule[day - 1] = person.name;
                                person.assigned.push(day);
                            }
                        });
                    });

                    // İstenmeyen günlere yerleştir
                    /*
                    for (let day = 0; day < daysInMonth; day++) {
                        if (schedule[day] === null) { // Boş olan günleri kontrol et
                            for (let person of persons) {
                                if (
                                    person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                    person.assigned.length < person.numShifts &&
                                    isConsecutiveAllowed(schedule, day, person)
                                ) {
                                    schedule[day] = person.name;
                                    person.assigned.push(day + 1);
                                    break;
                                }
                            }
                        }
                    }
                    */

                    // İstenmeyen günlere yerleştir
                    /*
                    for (let day = 0; day < daysInMonth; day++) {
                        if (schedule[day] === null) { // Boş olan günleri kontrol et
                            for (let person of persons) {
                                if (
                                    person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                    person.assigned.length < person.numShifts &&
                                    isConsecutiveAllowed(schedule, day, person)
                                ) {
                                    schedule[day] = person.name;
                                    person.assigned.push(day + 1);
                                    break;
                                }
                            }
                        }
                    }

                    */
                    for (let day = 0; day < daysInMonth; day++) {
                        if (schedule[day] === null) { // Boş olan günleri kontrol et
                            for (let person of persons) {
                                if (
                                    istenmeyengunler.includes(day+1) &&
                                    !person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                    person.assigned.length < person.numShifts &&
                                    isConsecutiveAllowed(schedule, day, person)
                                ) {
                                    schedule[day] = person.name;
                                    person.assigned.push(day + 1);
                                    break;
                                }
                            }
                        }
                    }
                    

                    // Kalan günleri doldur
                    for (let day = 0; day < daysInMonth; day++) {
                        if (schedule[day] === null) {
                            for (let person of persons) {
                                if (
                                    !person.notPreferred.includes(day + 1) &&
                                    person.assigned.length < person.numShifts &&
                                    isConsecutiveAllowed(schedule, day, person)
                                ) {
                                    schedule[day] = person.name;
                                    person.assigned.push(day + 1);
                                    break;
                                }
                            }
                        }
                    }

                    if (!schedule.includes(null)) {
                        success = true;
                        break;
                    }
                    attempt++;
                }
            }

            if (schedule.includes(null)) {
                alert("Tüm günleri doldurmak mümkün olmadı.");
            } else {
                console.log("Nöbet başarıyla oluşturuldu!");
            }
            doktorshedule=[...schedule];
            /*
            if (yspshedule.length>0 && doktorshedule.length>0) {
                createOfficialLists(doktorshedule, yspshedule, daysInMonth)
            }
            */
            submitButton.disabled = false; // İşlem bittiğinde butonu aktif yap

            // Tabloyu güncelleme işlemi
            const tableBody = document.getElementById('nobetList');
            tableBody.innerHTML = '';
            tableBody.style.display = 'table-row-group';

            let row = document.createElement('tr');
            let currentDay = 0;
            let firstDay = new Date(year, month - 1, 1).getDay();
            firstDay = (firstDay === 0) ? 7 : firstDay;

            for (let i = 1; i < firstDay; i++) {
                const emptyCell = document.createElement('td');
                row.appendChild(emptyCell);
                currentDay++;
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('td');
                cell.textContent = `${day} - ${schedule[day - 1] || 'Boş'}`;
                row.appendChild(cell);
                currentDay++;

                if (currentDay % 7 === 0 || day === daysInMonth) {
                    tableBody.appendChild(row);
                    row = document.createElement('tr');
                }
            }
        });


    
        function isConsecutiveAllowed(schedule, day, person) {
            const maxConsecutive = person.maxConsecutive;
            let count = 0;

            // Öncesine bak
            for (let i = day - 1; i >= 0; i--) {
                if (schedule[i] === person.name) count++;
                else break;
            }

            // Sonrasına bak
            for (let i = day + 1; i < schedule.length; i++) {
                if (schedule[i] === person.name) count++;
                else break;
            }

            return count < maxConsecutive;
        }
        
            
        function isConsecutiveAllowedResmi(schedule, day, person) {
            const maxConsecutive = 1;
            let count = 0;

            // Öncesine bak
            for (let i = day - 1; i >= 0; i--) {
                if (schedule[i] === person.name) count++;
                else break;
            }

            // Sonrasına bak
            for (let i = day + 1; i < schedule.length; i++) {
                if (schedule[i] === person.name) count++;
                else break;
            }

            return count < maxConsecutive;
        }

////////////////////////////////////////////

        document.getElementById('numPersons2').addEventListener('input', function () {
            const numPersons = parseInt(this.value) < 0 || parseInt(this.value) > 31 ? 31 : parseInt(this.value);  
            const personDetails = document.getElementById('personDetails2');
            personDetails.innerHTML = '';

            for (let i = 0; i < numPersons; i++) {
                personDetails.innerHTML += `
                    <fieldset>
                        <legend>Kişi ${i + 1}</legend>
                        <label for="name2_${i}">Ad (gerekli):</label>
                        <input type="text" id="name2_${i}" name="name2_${i}" required><br><br>

                        <label for="notPreferred2_${i}">İstemediği Günler (Virgül ile) (opsiyonel):</label>
                        <input type="text" id="notPreferred2_${i}" name="notPreferred2_${i}"><br><br>

                        <label for="preferred2_${i}">İstediği Günler (Virgül ile) (opsiyonel):</label>
                        <input type="text" id="preferred2_${i}" name="preferred2_${i}"><br><br>

                        <label for="maxConsecutive2_${i}">En Fazla Üst Üste Nöbet (blok) (Blok tutmamak için 1 giriniz.) (gerekli):</label>
                        <input type="number" id="maxConsecutive2_${i}" name="maxConsecutive2_${i}" min="1" required><br><br>

                        <label for="izinler2_${i}">En Fazla Üst Üste Nöbet (blok) (Blok tutmamak için 1 giriniz.) (gerekli):</label>
                        <input type="number" id="izinler2_${i}" name="izinler2_${i}" min="1" required><br><br>

                        <label for="numShifts2_${i}">Kaç Nöbet Tutacak (gerekli):</label>
                        <input type="number" id="numShifts2_${i}" name="numShifts2_${i}" min="1" required><br><br>
                    </fieldset>
                `;
            }
        }); 


        document.getElementById('nobetForm2').addEventListener('submit', async function (event) {
            event.preventDefault();

            const submitButton = document.getElementById('nobetButton2');
            submitButton.disabled = true; // Butonu pasif yap

            const year = parseInt(document.getElementById('year2').value);
            const month = parseInt(document.getElementById('month2').value);
            
            const numPersons = parseInt(document.getElementById('numPersons2').value) < 0 || parseInt(document.getElementById('numPersons2').value) > 31 ? 31 : parseInt(document.getElementById('numPersons2').value); 
            const daysInMonth = new Date(year, month, 0).getDate();

            let istenmeyengunler=[];
            let persons = [];
            

            for (let i = 0; i < numPersons; i++) {
                const name = document.getElementById(`name2_${i}`).value;
                const notPreferred = document.getElementById(`notPreferred2_${i}`).value.split(',').map(d => parseInt(d.trim())).filter(d => !isNaN(d));
                const preferred = document.getElementById(`preferred2_${i}`).value.split(',').map(d => parseInt(d.trim())).filter(d => !isNaN(d));
                const maxConsecutive = parseInt(document.getElementById(`maxConsecutive2_${i}`).value) || daysInMonth;
                const numShifts = parseInt(document.getElementById(`numShifts2_${i}`).value);
                if (notPreferred.length>0){
                    for (let myday of notPreferred){
                        istenmeyengunler.push(myday);
                        //if (!istenmeyengunler.includes(myday)){
                        //    istenmeyengunler.push(myday);
                        //};
                    }
                    
                } 
                
                persons.push({ name, notPreferred, preferred, maxConsecutive, numShifts, assigned: [] });
            }
            console.log(istenmeyengunler);
            persons.sort((a, b) => a.numShifts - b.numShifts); // Kişileri vardiya sayısına göre sırala
            let schedule = Array(daysInMonth).fill(null);
            let attempt = 0;
            let success = false;

            // Birinci while döngüsü
            while (attempt < 10000) {
                persons = shuffleArray(persons);
                schedule = Array(daysInMonth).fill(null);
                persons.forEach(person => person.assigned = []);
                

                // İstenen günlere yerleştir
                persons.forEach(person => {
                    person.preferred.forEach(day => {
                        if (schedule[day - 1] === null && person.assigned.length < person.numShifts) {
                            schedule[day - 1] = person.name;
                            person.assigned.push(day);
                        }
                    });
                });

                
                // İstenmeyen günlere yerleştir
                /*
                for (let day = 0; day < daysInMonth; day++) {
                    if (schedule[day] === null) { // Boş olan günleri kontrol et
                        for (let person of persons) {
                            if (
                                person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowed(schedule, day, person)
                            ) {
                                schedule[day] = person.name;
                                person.assigned.push(day + 1);
                                break;
                            }
                        }
                    }
                }

                */
                istenmeyengunler.forEach(mymyday => {
                    if (schedule[mymyday-1] === null) {
                        for (let i = 0; i < persons.length; i++) {
                            //const personIndex = getNextPersonIndex(persons, sira);
                            //const person = persons[personIndex];
                            var person = persons[sira % (persons.length-istenmeyengunler.filter(item => item === mymyday).length)]
                            if (
                                !person.notPreferred.includes(mymyday) &&
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowed(schedule, (mymyday-1), person)
                            ) {
                                schedule[mymyday-1] = person.name;
                                person.assigned.push(mymyday);
                                sira++;
                                break;
                            }
                            //sira++;
                        }
                    }
                });
                /*
                for (let day = 0; day < daysInMonth; day++) {
                    if (schedule[day] === null) { // Boş olan günleri kontrol et
                        for (let p of persons) {
                            //const personIndex = getNextPersonIndex(persons, sira);
                            //const person = persons[personIndex];
                            var person = persons[sira % persons.length]
                            if (
                                istenmeyengunler.includes(day+1) &&
                                !person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowed(schedule, day, person)
                            ) {
                                schedule[day] = person.name;
                                person.assigned.push(day + 1);
                                break;
                                sira++;
                            }
                            //sira++;
                        }
                    }
                }
                */

                // Kalan günleri doldur
                for (let day = 0; day < daysInMonth; day++) {
                    if (schedule[day] === null) {
                        for (let i = 0; i < persons.length; i++) {
                            const personIndex = getNextPersonIndex(persons, sira);
                            const person = persons[personIndex];

                            if (
                                !person.notPreferred.includes(day + 1) &&
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowed(schedule, day, person)
                            ) {
                                schedule[day] = person.name;
                                person.assigned.push(day + 1);
                                sira++;
                                break;
                            }
                            sira++;
                        }
                    }
                }

                if (!schedule.includes(null)) {
                    success = true;
                    break;
                }
                attempt++;
            }

            // Eğer birinci döngü başarısız olursa ikinci while döngüsüne geçilir
            if (!success) {
                console.log("Birinci döngü başarısız oldu, ikinci döngü başlıyor...");
                attempt = 0;
                sira = 2; // İkinci döngü için sırayı başa al
                while (attempt < 10000) {
                    persons = shuffleArray2(persons); // İkinci döngüde farklı bir karıştırma algoritması kullanılıyor
                    schedule = Array(daysInMonth).fill(null);
                    persons.forEach(person => person.assigned = []);

                    // İstenen günlere yerleştir
                    persons.forEach(person => {
                        person.preferred.forEach(day => {
                            if (schedule[day - 1] === null && person.assigned.length < person.numShifts) {
                                schedule[day - 1] = person.name;
                                person.assigned.push(day);
                            }
                        });
                    });

                    // İstenmeyen günlere yerleştir
                    /*
                    for (let day = 0; day < daysInMonth; day++) {
                        if (schedule[day] === null) { // Boş olan günleri kontrol et
                            for (let person of persons) {
                                if (
                                    person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                    person.assigned.length < person.numShifts &&
                                    isConsecutiveAllowed(schedule, day, person)
                                ) {
                                    schedule[day] = person.name;
                                    person.assigned.push(day + 1);
                                    break;
                                }
                            }
                        }
                    }
                    */

                    // İstenmeyen günlere yerleştir
                    /*
                    for (let day = 0; day < daysInMonth; day++) {
                        if (schedule[day] === null) { // Boş olan günleri kontrol et
                            for (let person of persons) {
                                if (
                                    person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                    person.assigned.length < person.numShifts &&
                                    isConsecutiveAllowed(schedule, day, person)
                                ) {
                                    schedule[day] = person.name;
                                    person.assigned.push(day + 1);
                                    break;
                                }
                            }
                        }
                    }

                    */
                    for (let day = 0; day < daysInMonth; day++) {
                        if (schedule[day] === null) { // Boş olan günleri kontrol et
                            for (let person of persons) {
                                if (
                                    istenmeyengunler.includes(day+1) &&
                                    !person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                    person.assigned.length < person.numShifts &&
                                    isConsecutiveAllowed(schedule, day, person)
                                ) {
                                    schedule[day] = person.name;
                                    person.assigned.push(day + 1);
                                    break;
                                }
                            }
                        }
                    }
                    

                    // Kalan günleri doldur
                    for (let day = 0; day < daysInMonth; day++) {
                        if (schedule[day] === null) {
                            for (let person of persons) {
                                if (
                                    !person.notPreferred.includes(day + 1) &&
                                    person.assigned.length < person.numShifts &&
                                    isConsecutiveAllowed(schedule, day, person)
                                ) {
                                    schedule[day] = person.name;
                                    person.assigned.push(day + 1);
                                    break;
                                }
                            }
                        }
                    }

                    if (!schedule.includes(null)) {
                        success = true;
                        break;
                    }
                    attempt++;
                }
            }

            if (schedule.includes(null)) {
                alert("Tüm günleri doldurmak mümkün olmadı.");
            } else {
                console.log("Nöbet başarıyla oluşturuldu!");
            }
            yspshedule=[...schedule];
            /*
            if (yspshedule.length>0 && doktorshedule.length>0) {
                createOfficialLists(doktorshedule, yspshedule, daysInMonth)
            }
            */
            submitButton.disabled = false; // İşlem bittiğinde butonu aktif yap

            // Tabloyu güncelleme işlemi
            const tableBody = document.getElementById('nobetList2');
            tableBody.innerHTML = '';
            tableBody.style.display = 'table-row-group';

            let row = document.createElement('tr');
            let currentDay = 0;
            let firstDay = new Date(year, month - 1, 1).getDay();
            firstDay = (firstDay === 0) ? 7 : firstDay;

            for (let i = 1; i < firstDay; i++) {
                const emptyCell = document.createElement('td');
                row.appendChild(emptyCell);
                currentDay++;
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('td');
                cell.textContent = `${day} - ${schedule[day - 1] || 'Boş'}`;
                row.appendChild(cell);
                currentDay++;

                if (currentDay % 7 === 0 || day === daysInMonth) {
                    tableBody.appendChild(row);
                    row = document.createElement('tr');
                }
            }
        });
    
        // Resmi liste oluşturma fonksiyonu
        // Resmi liste oluşturma fonksiyonu
        function createOfficialLists(doktorGizliListe, hemsireGizliListe, daysInMonth) {
            const nobetList3 = document.getElementById('nobetList3');
            const nobetList4 = document.getElementById('nobetList4');

            nobetList3.innerHTML = '';
            nobetList4.innerHTML = '';

            const doktorResmiListe = new Array(daysInMonth).fill("Boş");
            const hemsireResmiListe = new Array(daysInMonth).fill("Boş");

            for (let day = 0; day < daysInMonth; day++) {
                const weekDay = new Date(new Date().getFullYear(), new Date().getMonth(), day + 1).getDay();

                // Blok nöbet kontrolü
                if (day > 0 && doktorResmiListe[day - 1] !== "Boş") continue;
                if (day > 0 && hemsireResmiListe[day - 1] !== "Boş") continue;

                // Hafta içi için tercih edilenleri seç
                if (weekDay !== 0 && weekDay !== 6) { // Pazar (0) ve Cumartesi (6) hariç
                    if (doktorGizliListe[day] !== "Boş" && doktorResmiListe[day] === "Boş") {
                        doktorResmiListe[day] = doktorGizliListe[day];
                    }
                    if (hemsireGizliListe[day] !== "Boş" && hemsireResmiListe[day] === "Boş") {
                        hemsireResmiListe[day] = hemsireGizliListe[day];
                    }
                } else {
                    // Hafta sonu farklı seçim yap
                    if (doktorGizliListe[day] !== "Boş" && doktorResmiListe[day] === "Boş") {
                        doktorResmiListe[day] = doktorGizliListe[day];
                    }
                    if (hemsireGizliListe[day] !== "Boş" && hemsireResmiListe[day] === "Boş") {
                        hemsireResmiListe[day] = hemsireGizliListe[day];
                    }
                }

                // Blok nöbet engellemek için bir sonraki gün kontrolü
                if (day + 1 < daysInMonth) {
                    if (doktorGizliListe[day] !== "Boş") {
                        doktorResmiListe[day + 1] = "Blok Önleme";
                    }
                    if (hemsireGizliListe[day] !== "Boş") {
                        hemsireResmiListe[day + 1] = "Blok Önleme";
                    }
                }
            }

            // Doktor Resmi Listeyi Tabloya Yaz
            let doktorRow = document.createElement('tr');
            for (let day = 0; day < daysInMonth; day++) {
                const cell = document.createElement('td');
                cell.textContent = `Gün ${day + 1}: ${doktorResmiListe[day]}`;
                doktorRow.appendChild(cell);
                if ((day + 1) % 7 === 0) {
                    nobetList3.appendChild(doktorRow);
                    doktorRow = document.createElement('tr');
                }
            }
            nobetList3.appendChild(doktorRow);

            // Hemşire Resmi Listeyi Tabloya Yaz
            let hemsireRow = document.createElement('tr');
            for (let day = 0; day < daysInMonth; day++) {
                const cell = document.createElement('td');
                cell.textContent = `Gün ${day + 1}: ${hemsireResmiListe[day]}`;
                hemsireRow.appendChild(cell);
                if ((day + 1) % 7 === 0) {
                    nobetList4.appendChild(hemsireRow);
                    hemsireRow = document.createElement('tr');
                }
            }
            nobetList4.appendChild(hemsireRow);
        }


        function resmiliste(doktorresmishedule,yspresmishedule) {
            // Tabloyu güncelleme işlemi Doktor Resmi
            const tableBody3 = document.getElementById('nobetList3');
            tableBody3.innerHTML = '';
            tableBody3.style.display = 'table-row-group';

            let row3 = document.createElement('tr');
            let currentDay3 = 0;
            let firstDay3 = new Date(year, month - 1, 1).getDay();
            firstDay3 = (firstDay3 === 0) ? 7 : firstDay3;

            for (let i = 1; i < firstDay3; i++) {
                const emptyCell = document.createElement('td');
                row.appendChild(emptyCell);
                currentDay3++;
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('td');
                cell.textContent = `${day} - ${doktorresmishedule[day - 1] || 'Boş'}`;
                row.appendChild(cell);
                currentDay3++;

                if (currentDay3 % 7 === 0 || day === daysInMonth) {
                    tableBody3.appendChild(row);
                    row = document.createElement('tr');
                }
            }

            //////

            // Tabloyu güncelleme işlemi YSP Resmi
            const tableBody = document.getElementById('nobetList4');
            tableBody.innerHTML = '';
            tableBody.style.display = 'table-row-group';

            let row = document.createElement('tr');
            let currentDay = 0;
            let firstDay = new Date(year, month - 1, 1).getDay();
            firstDay = (firstDay === 0) ? 7 : firstDay;

            for (let i = 1; i < firstDay; i++) {
                const emptyCell = document.createElement('td');
                row.appendChild(emptyCell);
                currentDay++;
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('td');
                cell.textContent = `${day} - ${yspresmishedule[day - 1] || 'Boş'}`;
                row.appendChild(cell);
                currentDay++;

                if (currentDay % 7 === 0 || day === daysInMonth) {
                    tableBody.appendChild(row);
                    row = document.createElement('tr');
                }
            }
        }
////////////////////////////////////////////   
        function getKeysFromObject(obj) {
            return Object.keys(obj);
        }

        function countElementsInList(list) {
            const elementCounts = {};

            list.forEach(item => {
                elementCounts[item] = (elementCounts[item] || 0) + 1;
            });

            return elementCounts;
        }

        function getDaysAndWeekdays() {
            const yearInput = document.getElementById("year");
            const monthInput = document.getElementById("month");

            if (!yearInput || !monthInput) {
                console.error("Yıl ve ay giriş elemanları bulunamadı!");
                return;
            }

            const year = parseInt(yearInput.value);
            const month = parseInt(monthInput.value);

            if (isNaN(year) || isNaN(month) || month < 1 || month > 12) {
                console.error("Geçerli bir yıl ve ay giriniz!");
                return;
            }

            const daysInMonth = new Date(year, month, 0).getDate();
            const allDays = [];
            const weekdays = [];

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month - 1, day);
                allDays.push(day);

                // 0 = Pazar, 6 = Cumartesi; hafta içi günleri 1 (Pazartesi) ile 5 (Cuma) arasındadır
                if (date.getDay() >= 1 && date.getDay() <= 5) {
                    weekdays.push(day);
                }
            }

            ///////////////////
            doktorresmishedule=[];
            yspresmishedule=[];

            const doktornobetsayisi = countElementsInList(doktorshedule);
            const yspnobetsayisi = countElementsInList(yspshedule);
            // Çıktı: { apple: 3, banana: 2, orange: 1 }
            const doktorlar= getKeysFromObject(doktornobetsayisi);
            const yspler= getKeysFromObject(yspnobetsayisi);
            var mydoktorpersons=[];
            var istenmeyengunler=[];
            ///
            for (let i = 0; i < doktorlar; i++) {
                const name = doktorlar[i];
                const izinler = document.getElementById(`izinler_${i}`).value.split(',').map(d => parseInt(d.trim())).filter(d => !isNaN(d));
                
                const maxConsecutive = 1;
                const numShifts = doktornobetsayisi.doktorlar[i]
                if (notPreferred.length>0){
                    for (let myday of notPreferred){
                        istenmeyengunler.push(myday);
                        //if (!istenmeyengunler.includes(myday)){
                        //    istenmeyengunler.push(myday);
                        //};
                    }
                    
                } 
                
                mydoktorpersons.push({ name, izinler, maxConsecutive, numShifts, assigned: [] });
            }
            ///
            var mysira=0;
            while (attempt < 10000) {
                mydoktorpersons = shuffleArray(mydoktorpersons);
                doktorresmishedule = Array(daysInMonth).fill(null);
                mydoktorpersons.forEach(person => person.assigned = []);
                
                mydoktorpersons.forEach(myp => {
                    
                
                    myp.izinler.forEach(mymyday => {

                        if (doktorresmishedule[mymyday-1] === null) {
                            for (let i = 0; i < mydoktorpersons.length; i++) {
                                //const personIndex = getNextPersonIndex(persons, sira);
                                //const person = persons[personIndex];
                                var person = mydoktorpersons[sira % (mydoktorpersons.length)]
                                if (
                                    !person.izinler.includes(mymyday) &&
                                    person.assigned.length < person.numShifts &&
                                    isConsecutiveAllowedResmi(doktorresmishedule, (mymyday-1), person)
                                ) {
                                    doktorresmishedule[mymyday-1] = person.name;
                                    person.assigned.push(mymyday);
                                    mysira++;
                                    break;
                                }
                                //sira++;
                            }
                        }
                    });
                });
                /*
                for (let day = 0; day < daysInMonth; day++) {
                    if (schedule[day] === null) { // Boş olan günleri kontrol et
                        for (let p of persons) {
                            //const personIndex = getNextPersonIndex(persons, sira);
                            //const person = persons[personIndex];
                            var person = persons[sira % persons.length]
                            if (
                                istenmeyengunler.includes(day+1) &&
                                !person.notPreferred.includes(day + 1) && // İstenmeyen günlerden biri mi?
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowed(schedule, day, person)
                            ) {
                                schedule[day] = person.name;
                                person.assigned.push(day + 1);
                                break;
                                sira++;
                            }
                            //sira++;
                        }
                    }
                }
                */

                // Kalan günleri doldur
                for (let day = 0; day < daysInMonth; day++) {
                    if (doktorresmishedule[day] === null) {
                        for (let i = 0; i < mydoktorpersons.length; i++) {
                            const personIndex = getNextPersonIndex(persons, sira);
                            const person = persons[personIndex];
                            var person=mydoktorpersons[mysira % mydoktorpersons.length];

                            if (
                                !person.izinler.includes(day + 1) &&
                                person.assigned.length < person.numShifts &&
                                isConsecutiveAllowedResmi(schedule, day, person)
                            ) {
                                schedule[day] = person.name;
                                person.assigned.push(day + 1);
                                mysira++;
                                break;
                            }
                            mysira++;
                        }
                    }
                }

                if (!schedule.includes(null)) {
                    success = true;
                    break;
                }
                attempt++;
            }


            resmiliste(doktorresmishedule,yspresmishedule)
            ////////////////////
            console.log("Tüm Günler:", allDays);
            console.log("Hafta İçi Günleri:", weekdays);

            return  [allDays, weekdays] ;
        }

        // Örnek kullanım
        document.getElementById("nobetButton").addEventListener("click", () => {
            const result = getDaysAndWeekdays();
            if (result) {
                console.log("Sonuç:", result);
            }
        });

    /*
    document.addEventListener('DOMContentLoaded', function () {
    const cookieConsent = document.getElementById('cookieConsent');
    const acceptCookies = document.getElementById('acceptCookies');
    const rejectCookies = document.getElementById('rejectCookies');

    // Çerez kontrolü
    if (!localStorage.getItem('cookieConsent')) {
        cookieConsent.style.display = 'block';
    }

    // Kabul Et düğmesi
    acceptCookies.addEventListener('click', function () {
        localStorage.setItem('cookieConsent', 'accepted');
        cookieConsent.style.display = 'none';
        // Gerekirse çerez ayarlarını veya izleme kodlarını etkinleştirin
    });

    // Reddet düğmesi
    rejectCookies.addEventListener('click', function () {
        localStorage.setItem('cookieConsent', 'rejected');
        cookieConsent.style.display = 'none';
        // Gerekirse çerez ayarlarını devre dışı bırakın
    });
    });
    */

    </script>

</body>
</html>